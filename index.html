<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ëƒ‰ì¥ê³  íŒŒë¨¹ê¸° ìš”ë¦¬ì‚¬</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { font-family: Pretendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif; }
        .animate-pulse-slow { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
        .tap-highlight-none { -webkit-tap-highlight-color: transparent; }
        .recipe-card:active { transform: scale(0.98); }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">

<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect } = React;

    const Icons = {
        Plus: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>,
        X: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>,
        ChefHat: () => <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z"></path><line x1="6" y1="17" x2="18" y2="17"></line></svg>,
        Youtube: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>,
        Sparkles: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"></path><path d="m5 3 1 1"></path><path d="m19 3-1 1"></path><path d="m5 19 1-1"></path><path d="m19 19-1-1"></path></svg>
    };

    const apiKey = ""; // API Key is automatically provided by the environment

    const App = () => {
        const [ingredients, setIngredients] = useState([]);
        const [input, setInput] = useState('');
        const [loading, setLoading] = useState(false);
        const [recipes, setRecipes] = useState([]);
        const [selectedRecipe, setSelectedRecipe] = useState(null);
        const [error, setError] = useState('');

        const addIngredient = () => {
            if (input.trim() && !ingredients.includes(input.trim())) {
                setIngredients([...ingredients, input.trim()]);
                setInput('');
            }
        };

        const removeIngredient = (ing) => {
            setIngredients(ingredients.filter(i => i !== ing));
        };

        const fetchRecipes = async () => {
            if (ingredients.length === 0) return;
            setLoading(true);
            setError('');
            
            const prompt = `ë‚´ê°€ ê°€ì§„ ì¬ë£ŒëŠ” ë‹¤ìŒê³¼ ê°™ì•„: ${ingredients.join(', ')}. 
            ì´ ì¬ë£Œë“¤ì„ ì£¼ë¡œ ì‚¬ìš©í•´ì„œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ì°½ì˜ì ì´ê³  ë§›ìˆëŠ” ìš”ë¦¬ 3ê°€ì§€ë¥¼ ì¶”ì²œí•´ì¤˜. 
            ë§Œì•½ 'íŠ¸ëŸ¬í”Œ' ê°™ì€ íŠ¹ìˆ˜ ì¬ë£Œê°€ ìˆë‹¤ë©´ ê·¸ê±¸ ì£¼ì¸ê³µìœ¼ë¡œ í•œ ìš”ë¦¬ë¥¼ ê¼­ í¬í•¨í•´ì¤˜.
            ë‹µë³€ì€ ë°˜ë“œì‹œ ì•„ë˜ JSON í˜•ì‹ì„ ì§€ì¼œì¤˜:
            {
                "recipes": [
                    {
                        "name": "ìš”ë¦¬ ì´ë¦„",
                        "description": "ìš”ë¦¬ì— ëŒ€í•œ ë§¤ë ¥ì ì¸ í•œ ì¤„ ì„¤ëª…",
                        "all_ingredients": ["í•„ìš”í•œ ëª¨ë“  ì¬ë£Œ ëª©ë¡"],
                        "steps": ["ìƒì„¸ ì¡°ë¦¬ ë‹¨ê³„ 1", "ìƒì„¸ ì¡°ë¦¬ ë‹¨ê³„ 2..."],
                        "time": "ì˜ˆìƒ ì‹œê°„(ìˆ«ìë§Œ)",
                        "difficulty": "ì‰¬ì›€/ë³´í†µ/ì–´ë ¤ì›€"
                    }
                ]
            }`;

            try {
                let attempts = 0;
                let success = false;
                let data;

                while (attempts < 5 && !success) {
                    try {
                        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                contents: [{ parts: [{ text: prompt }] }],
                                generationConfig: { 
                                    responseMimeType: "application/json",
                                    temperature: 0.7 
                                }
                            })
                        });
                        
                        if (!response.ok) throw new Error('API ì‘ë‹µì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                        
                        const result = await response.json();
                        const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                        data = JSON.parse(text);
                        success = true;
                    } catch (e) {
                        attempts++;
                        if (attempts === 5) throw e;
                        await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempts) * 1000));
                    }
                }

                if (success && data.recipes) {
                    setRecipes(data.recipes);
                } else {
                    throw new Error('ë°ì´í„° í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                }
            } catch (err) {
                setError('AI ìš”ë¦¬ì‚¬ê°€ ê³ ë¯¼ì— ë¹ ì¡Œì–´ìš”. ì ì‹œ í›„ ë‹¤ì‹œ ë¬¼ì–´ë´ì£¼ì„¸ìš”!');
            } finally {
                setLoading(false);
            }
        };

        return (
            <div className="min-h-screen pb-20 tap-highlight-none selection:bg-orange-100">
                <header className="bg-orange-500 text-white px-6 py-10 shadow-lg text-center rounded-b-[40px]">
                    <div className="flex justify-center mb-3 animate-bounce"><Icons.ChefHat /></div>
                    <h1 className="text-3xl font-black tracking-tight">AI ëƒ‰ì¥ê³  íŒŒë¨¹ê¸° ìš”ë¦¬ì‚¬</h1>
                    <p className="text-orange-100 text-sm mt-2 opacity-90">ì¬ë£Œë§Œ ì•Œë ¤ì£¼ì‹œë©´ ì¸ê³µì§€ëŠ¥ì´ ë©”ë‰´ë¥¼ ì§œë“œë ¤ìš”!</p>
                </header>

                <main className="max-w-xl mx-auto p-5 -mt-10">
                    {/* Input Section */}
                    <div className="bg-white rounded-[32px] shadow-2xl p-7 mb-8 border border-white/20">
                        <label className="block text-xs font-black text-slate-400 uppercase tracking-widest mb-3 ml-1">ë‚˜ì˜ ëƒ‰ì¥ê³  ì¬ë£Œ</label>
                        <div className="flex gap-2 mb-5">
                            <input 
                                type="text"
                                value={input}
                                onChange={(e) => setInput(e.target.value)}
                                onKeyDown={(e) => e.key === 'Enter' && addIngredient()}
                                placeholder="ì¬ë£Œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: íŠ¸ëŸ¬í”Œ)"
                                className="flex-1 bg-slate-100 border-2 border-transparent rounded-2xl px-5 py-4 focus:border-orange-400 focus:bg-white outline-none text-lg transition-all"
                            />
                            <button onClick={addIngredient} className="bg-orange-500 text-white w-14 h-14 rounded-2xl hover:bg-orange-600 transition flex items-center justify-center shadow-lg shadow-orange-200 active:scale-90">
                                <Icons.Plus />
                            </button>
                        </div>

                        <div className="flex flex-wrap gap-2 mb-8 min-h-[40px]">
                            {ingredients.map(ing => (
                                <span key={ing} className="bg-orange-50 text-orange-700 px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 border border-orange-100 animate-fadeIn">
                                    {ing}
                                    <button onClick={() => removeIngredient(ing)} className="text-orange-300 hover:text-orange-600"><Icons.X /></button>
                                </span>
                            ))}
                            {ingredients.length === 0 && <p className="text-slate-300 text-sm py-2">ëƒ‰ì¥ê³ ì— ë‚¨ì€ ì¬ë£Œë“¤ì„ ì¶”ê°€í•´ë³´ì„¸ìš”.</p>}
                        </div>

                        <button 
                            onClick={fetchRecipes}
                            disabled={loading || ingredients.length === 0}
                            className={`w-full py-5 rounded-2xl font-black text-xl flex items-center justify-center gap-3 transition-all shadow-xl ${loading || ingredients.length === 0 ? 'bg-slate-100 text-slate-300 cursor-not-allowed shadow-none' : 'bg-orange-500 text-white hover:bg-orange-600 active:scale-[0.98] shadow-orange-200'}`}
                        >
                            {loading ? (
                                <div className="flex items-center gap-2 animate-pulse-slow">
                                    <Icons.Sparkles /> ìµœê³ ì˜ ë ˆì‹œí”¼ ì°¾ëŠ” ì¤‘...
                                </div>
                            ) : (
                                <><Icons.Sparkles /> AI ì¶”ì²œ ìš”ë¦¬ ë³´ê¸°</>
                            )}
                        </button>
                    </div>

                    {error && <div className="bg-red-50 text-red-600 p-5 rounded-2xl text-center font-bold mb-6 border border-red-100 animate-fadeIn">{error}</div>}

                    {/* Recipe List */}
                    <div className="space-y-4">
                        {recipes.map((recipe, idx) => (
                            <div 
                                key={idx}
                                onClick={() => setSelectedRecipe(recipe)}
                                className="bg-white p-6 rounded-[28px] border-2 border-transparent hover:border-orange-400 shadow-md hover:shadow-xl transition-all cursor-pointer recipe-card"
                            >
                                <div className="flex justify-between items-start mb-3">
                                    <h3 className="text-xl font-black text-slate-800 tracking-tight">{recipe.name}</h3>
                                    <span className="text-[10px] font-black px-2.5 py-1 bg-orange-100 text-orange-600 rounded-full">{recipe.difficulty}</span>
                                </div>
                                <p className="text-sm text-slate-500 mb-4 line-clamp-2 leading-relaxed">{recipe.description}</p>
                                <div className="flex gap-5 text-xs font-bold text-slate-400">
                                    <span className="flex items-center gap-1.5">â± {recipe.time}ë¶„ ì†Œìš”</span>
                                    <span className="flex items-center gap-1.5">ğŸ³ ì¬ë£Œ {recipe.all_ingredients.length}ê°œ</span>
                                </div>
                            </div>
                        ))}
                    </div>
                </main>

                {/* Detail Modal */}
                {selectedRecipe && (
                    <div className="fixed inset-0 bg-slate-900/90 backdrop-blur-lg z-50 p-4 flex items-center justify-center" onClick={() => setSelectedRecipe(null)}>
                        <div className="bg-white rounded-[40px] w-full max-w-lg max-h-[90vh] shadow-2xl overflow-y-auto animate-scaleIn" onClick={e => e.stopPropagation()}>
                            <div className="relative p-8 sm:p-10">
                                <button onClick={() => setSelectedRecipe(null)} className="absolute top-6 right-6 p-3 bg-slate-50 rounded-full text-slate-400 hover:text-slate-600 transition active:scale-90">
                                    <Icons.X />
                                </button>
                                
                                <div className="mb-8">
                                    <h2 className="text-3xl font-black text-slate-900 mb-3 leading-tight pr-10">{selectedRecipe.name}</h2>
                                    <p className="text-slate-500 font-medium leading-relaxed">{selectedRecipe.description}</p>
                                </div>

                                <div className="grid grid-cols-2 gap-3 mb-10">
                                    <div className="bg-slate-50 p-4 rounded-3xl text-center">
                                        <span className="block text-[10px] font-black text-slate-400 uppercase mb-1 tracking-tighter">ì˜ˆìƒ ì¡°ë¦¬ì‹œê°„</span>
                                        <span className="font-bold text-slate-800">{selectedRecipe.time}ë¶„</span>
                                    </div>
                                    <div className="bg-slate-50 p-4 rounded-3xl text-center">
                                        <span className="block text-[10px] font-black text-slate-400 uppercase mb-1 tracking-tighter">ìš”ë¦¬ ë‚œì´ë„</span>
                                        <span className="font-bold text-slate-800">{selectedRecipe.difficulty}</span>
                                    </div>
                                </div>

                                <div className="mb-10">
                                    <h4 className="font-black text-lg mb-5 flex items-center gap-2 text-slate-800">
                                        <span className="w-1.5 h-6 bg-orange-500 rounded-full"></span>
                                        í•„ìš”í•œ ì¬ë£Œ
                                    </h4>
                                    <div className="flex flex-wrap gap-2">
                                        {selectedRecipe.all_ingredients.map((ing, i) => {
                                            const haveIt = ingredients.some(my => ing.includes(my) || my.includes(ing));
                                            return (
                                                <span key={i} className={`px-4 py-2.5 rounded-2xl text-sm font-bold border-2 transition-all ${haveIt ? 'bg-orange-500 border-orange-500 text-white shadow-lg shadow-orange-100' : 'bg-slate-50 border-slate-100 text-slate-400'}`}>
                                                    {ing} {haveIt && 'âœ“'}
                                                </span>
                                            );
                                        })}
                                    </div>
                                </div>

                                <div className="mb-10">
                                    <h4 className="font-black text-lg mb-6 flex items-center gap-2 text-slate-800">
                                        <span className="w-1.5 h-6 bg-orange-500 rounded-full"></span>
                                        ìš”ë¦¬ ìˆœì„œ
                                    </h4>
                                    <div className="space-y-6">
                                        {selectedRecipe.steps.map((step, i) => (
                                            <div key={i} className="flex gap-5">
                                                <span className="shrink-0 w-8 h-8 rounded-xl bg-slate-900 text-white flex items-center justify-center font-black text-sm shadow-xl">{i + 1}</span>
                                                <p className="text-slate-700 leading-relaxed font-medium pt-1">{step}</p>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <a 
                                    href={`https://www.youtube.com/results?search_query=${encodeURIComponent(selectedRecipe.name + ' ë ˆì‹œí”¼')}`}
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    className="block w-full bg-[#FF0000] text-white py-5 rounded-[28px] font-black text-center text-lg shadow-xl shadow-red-100 hover:brightness-110 active:scale-[0.98] transition-all flex items-center justify-center gap-3"
                                >
                                    <Icons.Youtube /> ìœ íŠœë¸Œ ì˜ìƒ ê°€ì´ë“œ ë³´ê¸°
                                </a>
                            </div>
                        </div>
                    </div>
                )}
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>
</body>
</html>
